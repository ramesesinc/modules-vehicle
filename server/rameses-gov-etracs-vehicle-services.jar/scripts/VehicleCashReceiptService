import com.rameses.annotations.*;

import com.rameses.util.*;
import java.text.*;
import java.util.regex.*;
import treasury.facts.*;
import vehicle.facts.*;

public class VehicleCashReceiptService {
	
	@Service("VehicleBillingService")
	def billingSvc;

	@ProxyMethod
	public def getBilling(def o ) {
		def billing = billingSvc.getBilling( o );

		def m = [:];
		m.payer = billing.owner;
		m.paidby = billing.owner.name;
		m.paidbyaddress = billing.owner.address.text;
		m.amount = billing.amount;

		m.items = [];
		def acctGroups = billing.billitems.groupBy { it.item.item }
		acctGroups.each { k,v->
			m.items = [ item: k, amount: v.sum{ it.amount }, remarks:'' ];
		}

		return m;
	}


}